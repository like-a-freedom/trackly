{
    "id": null,
    "uid": "platform-host",
    "title": "Platform / Host",
    "schemaVersion": 39,
    "version": 1,
    "tags": [
        "platform",
        "node"
    ],
    "templating": {
        "list": [
            {
                "name": "instance",
                "type": "query",
                "query": "label_values(node_cpu_seconds_total, instance)",
                "includeAll": true
            }
        ]
    },
    "panels": [
        {
            "type": "graph",
            "title": "CPU Usage",
            "targets": [
                {
                    "expr": "100 - (avg by(instance)(rate(node_cpu_seconds_total{mode='idle',instance=~\"$instance\"}[5m])) * 100)"
                }
            ]
        },
        {
            "type": "graph",
            "title": "Memory Usage",
            "targets": [
                {
                    "expr": "(node_memory_MemTotal_bytes{instance=~\"$instance\"} - node_memory_MemAvailable_bytes{instance=~\"$instance\"}) / node_memory_MemTotal_bytes{instance=~\"$instance\"}"
                }
            ]
        },
        {
            "type": "graph",
            "title": "Disk Free",
            "targets": [
                {
                    "expr": "node_filesystem_free_bytes{fstype!~'tmpfs|aufs',instance=~\"$instance\"} / node_filesystem_size_bytes{fstype!~'tmpfs|aufs',instance=~\"$instance\"}"
                }
            ]
        },
        {
            "type": "graph",
            "title": "Container CPU (cadvisor)",
            "targets": [
                {
                    "expr": "sum by(container_label_com_docker_swarm_service_name) (rate(container_cpu_usage_seconds_total{container_label_com_docker_swarm_service_name!='',instance=~\"$instance\"}[5m]))"
                }
            ]
        },
        {
            "type": "graph",
            "title": "Container Memory (cadvisor)",
            "targets": [
                {
                    "expr": "sum by(container_label_com_docker_swarm_service_name) (container_memory_working_set_bytes{container_label_com_docker_swarm_service_name!='',instance=~\"$instance\"})"
                }
            ]
        },
        {
            "type": "graph",
            "title": "Container Restarts",
            "targets": [
                {
                    "expr": "sum(rate(container_last_seen{instance=~\"$instance\"}[5m]))"
                }
            ]
        }
    ]
}